# üè∑Ô∏è –°–∏—Å—Ç–µ–º–∞ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤ —Ç–æ–≤–∞—Ä–æ–≤

## üìã –û–±–∑–æ—Ä

–ü–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ —Ç–æ–≤–∞—Ä–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –≤ –∫–∞—Ç–∞–ª–æ–≥–µ. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –∞—Ç—Ä–∏–±—É—Ç—ã (—Ü–≤–µ—Ç, —Ä–∞–∑–º–µ—Ä, –º–∞—Ç–µ—Ä–∏–∞–ª –∏ —Ç.–¥.), —É–ø—Ä–∞–≤–ª—è—Ç—å –∏—Ö –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –∏ –Ω–∞–∑–Ω–∞—á–∞—Ç—å –∞—Ç—Ä–∏–±—É—Ç—ã —Ç–æ–≤–∞—Ä–∞–º. –ü–æ–∫—É–ø–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —Ç–æ–≤–∞—Ä—ã –ø–æ –∞—Ç—Ä–∏–±—É—Ç–∞–º –≤ –∫–∞—Ç–∞–ª–æ–≥–µ.

## üóÑÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### 1. –¢–∞–±–ª–∏—Ü–∞ `attributes`
–•—Ä–∞–Ω–∏—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∞—Ç—Ä–∏–±—É—Ç–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "Farbe", "Gr√∂√üe", "Hauttyp").

```sql
CREATE TABLE public.attributes (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name TEXT NOT NULL UNIQUE,
    slug TEXT NOT NULL UNIQUE,
    type TEXT NOT NULL CHECK (type IN ('select', 'multiselect', 'text', 'number', 'boolean')),
    display_order INTEGER DEFAULT 0,
    filterable BOOLEAN DEFAULT true,
    visible_in_catalog BOOLEAN DEFAULT true,
    created_at TIMESTAMPTZ DEFAULT now(),
    updated_at TIMESTAMPTZ DEFAULT now()
);
```

**–¢–∏–ø—ã –∞—Ç—Ä–∏–±—É—Ç–æ–≤:**
- `select` - –æ–¥–∏–Ω–æ—á–Ω—ã–π –≤—ã–±–æ—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–∞–∑–º–µ—Ä)
- `multiselect` - –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–∏–ø—ã –∫–æ–∂–∏)
- `text` - —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ
- `number` - —á–∏—Å–ª–æ–≤–æ–µ –ø–æ–ª–µ
- `boolean` - –¥–∞/–Ω–µ—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, "Bio", "Vegan")

### 2. –¢–∞–±–ª–∏—Ü–∞ `attribute_values`
–•—Ä–∞–Ω–∏—Ç –ø—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –∞—Ç—Ä–∏–±—É—Ç–æ–≤ —Ç–∏–ø–∞ select/multiselect.

```sql
CREATE TABLE public.attribute_values (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    attribute_id UUID NOT NULL REFERENCES public.attributes(id) ON DELETE CASCADE,
    value TEXT NOT NULL,
    slug TEXT NOT NULL,
    display_order INTEGER DEFAULT 0,
    created_at TIMESTAMPTZ DEFAULT now(),
    UNIQUE(attribute_id, slug)
);
```

### 3. –¢–∞–±–ª–∏—Ü–∞ `product_attributes`
–°–≤—è–∑—ã–≤–∞–µ—Ç —Ç–æ–≤–∞—Ä—ã —Å –∏—Ö –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏ (junction table).

```sql
CREATE TABLE public.product_attributes (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    product_id UUID NOT NULL REFERENCES public.products(id) ON DELETE CASCADE,
    attribute_id UUID NOT NULL REFERENCES public.attributes(id) ON DELETE CASCADE,
    attribute_value_id UUID REFERENCES public.attribute_values(id) ON DELETE CASCADE,
    custom_value TEXT,
    created_at TIMESTAMPTZ DEFAULT now(),
    UNIQUE(product_id, attribute_id, attribute_value_id)
);
```

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –®–∞–≥ 1: –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL-—Å–∫—Ä–∏–ø—Ç –≤ Supabase SQL Editor:

```bash
supabase/migrations/20250207_create_attributes_system.sql
```

–≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç:
- –í—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–∞–±–ª–∏—Ü—ã
- –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
- RLS –ø–æ–ª–∏—Ç–∏–∫–∏
- –ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã –¥–ª—è –∫–æ—Å–º–µ—Ç–∏—á–µ—Å–∫–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞

### –®–∞–≥ 2: –ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã

–ú–∏–≥—Ä–∞—Ü–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –∞—Ç—Ä–∏–±—É—Ç—ã:

1. **Farbe** (–¶–≤–µ—Ç) - select
   - Schwarz, Wei√ü, Rot, Rosa, Blau, Gold, Silber

2. **Gr√∂√üe** (–†–∞–∑–º–µ—Ä) - select
   - Klein, Mittel, Gro√ü, Extra Gro√ü

3. **Material** (–ú–∞—Ç–µ—Ä–∏–∞–ª) - select

4. **Hauttyp** (–¢–∏–ø –∫–æ–∂–∏) - multiselect
   - Normale Haut, Trockene Haut, Fettige Haut, Mischhaut, Empfindliche Haut

5. **Marke** (–ë—Ä–µ–Ω–¥) - select

6. **Volumen** (–û–±—ä–µ–º) - select
   - 30ml, 50ml, 100ml, 200ml, 500ml, 1L

7. **Duft** (–ê—Ä–æ–º–∞—Ç) - select

8. **Bio** (–ë–∏–æ) - boolean

9. **Vegan** (–í–µ–≥–∞–Ω) - boolean

10. **Tierversuchsfrei** (–ë–µ–∑ —Ç–µ—Å—Ç–æ–≤ –Ω–∞ –∂–∏–≤–æ—Ç–Ω—ã—Ö) - boolean

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
‚îú‚îÄ‚îÄ supabase/migrations/
‚îÇ   ‚îî‚îÄ‚îÄ 20250207_create_attributes_system.sql  # SQL –º–∏–≥—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ lib/types/
‚îÇ   ‚îî‚îÄ‚îÄ attributes.ts                          # TypeScript —Ç–∏–ø—ã
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ admin/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ attributes/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ route.ts                   # CRUD –¥–ª—è –∞—Ç—Ä–∏–±—É—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ [id]/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ route.ts               # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–∞
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ values/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ route.ts           # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ values/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ [valueId]/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ           ‚îî‚îÄ‚îÄ route.ts           # –£–¥–∞–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ products/
‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ attributes/
‚îÇ   ‚îÇ   ‚îÇ           ‚îî‚îÄ‚îÄ route.ts               # –ü—Ä–∏–≤—è–∑–∫–∞ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –∫ —Ç–æ–≤–∞—Ä–∞–º
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ products/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ route.ts                       # –û–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ admin/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ attributes/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ page.tsx                       # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ products/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ create/
‚îÇ   ‚îÇ           ‚îî‚îÄ‚îÄ page.tsx                   # –§–æ—Ä–º–∞ —Å –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏
‚îÇ   ‚îî‚îÄ‚îÄ catalog/
‚îÇ       ‚îî‚îÄ‚îÄ page.tsx                           # –ö–∞—Ç–∞–ª–æ–≥ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
‚îî‚îÄ‚îÄ components/
    ‚îî‚îÄ‚îÄ catalog/
        ‚îî‚îÄ‚îÄ AttributeFilters.tsx               # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Ñ–∏–ª—å—Ç—Ä–æ–≤
```

## üéØ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

#### 1. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏
–ü–µ—Ä–µ–π–¥–∏—Ç–µ: `/admin/attributes`

**–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∞—Ç—Ä–∏–±—É—Ç:**
1. –ù–∞–∂–º–∏—Ç–µ "Neues Attribut"
2. –í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "Hauttyp")
3. –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø (select, multiselect, boolean –∏ —Ç.–¥.)
4. –ù–∞–∂–º–∏—Ç–µ "Erstellen"

**–î–æ–±–∞–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –∞—Ç—Ä–∏–±—É—Ç–∞:**
1. –†–∞—Å–∫—Ä–æ–π—Ç–µ –∞—Ç—Ä–∏–±—É—Ç (–Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –Ω–µ–≥–æ)
2. –í–≤–µ–¥–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –ø–æ–ª–µ "Neuer Wert"
3. –ù–∞–∂–º–∏—Ç–µ "Hinzuf√ºgen"
4. –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –¥–ª—è –≤—Å–µ—Ö –∑–Ω–∞—á–µ–Ω–∏–π

**–£–¥–∞–ª–∏—Ç—å –∞—Ç—Ä–∏–±—É—Ç –∏–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ:**
- –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∏–∫–æ–Ω–∫—É –∫–æ—Ä–∑–∏–Ω—ã —Ä—è–¥–æ–º —Å —ç–ª–µ–º–µ–Ω—Ç–æ–º

#### 2. –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ —Ç–æ–≤–∞—Ä—É
–ü–µ—Ä–µ–π–¥–∏—Ç–µ: `/admin/products/create` –∏–ª–∏ `/admin/products/[id]/edit`

–í —Ñ–æ—Ä–º–µ —Ç–æ–≤–∞—Ä–∞:
1. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—è (–Ω–∞–∑–≤–∞–Ω–∏–µ, —Ü–µ–Ω–∞ –∏ —Ç.–¥.)
2. –ü—Ä–æ–∫—Ä—É—Ç–∏—Ç–µ –¥–æ —Ä–∞–∑–¥–µ–ª–∞ "Produktattribute"
3. –í—ã–±–µ—Ä–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞—Ç—Ä–∏–±—É—Ç–∞:
   - **Select**: –≤—ã–±–µ—Ä–∏—Ç–µ –æ–¥–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ —Å–ø–∏—Å–∫–∞
   - **Multiselect**: –≤—ã–±–µ—Ä–∏—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–Ω–∞—á–µ–Ω–∏–π —á–µ—Ä–µ–∑ —á–µ–∫–±–æ–∫—Å—ã
   - **Boolean**: –ø–æ—Å—Ç–∞–≤—å—Ç–µ –≥–∞–ª–æ—á–∫—É "Ja/Nein"
4. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ç–æ–≤–∞—Ä

### –î–ª—è –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π

#### –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≤ –∫–∞—Ç–∞–ª–æ–≥–µ
–ü–µ—Ä–µ–π–¥–∏—Ç–µ: `/catalog`

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤:**
1. –ù–∞ –¥–µ—Å–∫—Ç–æ–ø–µ —Ñ–∏–ª—å—Ç—Ä—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ –ª–µ–≤–æ–π –ø–∞–Ω–µ–ª–∏
2. –†–∞—Å–∫—Ä–æ–π—Ç–µ –∞—Ç—Ä–∏–±—É—Ç, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è
3. –í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (–º–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ)
4. –¢–æ–≤–∞—Ä—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç—Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è
5. –ù–∞–∂–º–∏—Ç–µ "Alle l√∂schen", —á—Ç–æ–±—ã —Å–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ —Ñ–∏–ª—å—Ç—Ä—ã

**–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤:**
- –§–∏–ª—å—Ç—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É AND (–≤—Å–µ —É—Å–ª–æ–≤–∏—è –¥–æ–ª–∂–Ω—ã –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è)
- –í–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–≥–æ –∞—Ç—Ä–∏–±—É—Ç–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç OR (–ø–æ–¥—Ö–æ–¥–∏—Ç –ª—é–±–æ–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)

**–ü—Ä–∏–º–µ—Ä:**
- Farbe: Rot, Rosa (OR - —Ç–æ–≤–∞—Ä –º–æ–∂–µ—Ç –±—ã—Ç—å –∫—Ä–∞—Å–Ω—ã–º –ò–õ–ò —Ä–æ–∑–æ–≤—ã–º)
- Hauttyp: Trockene Haut (AND - —Ç–æ–≤–∞—Ä –î–û–õ–ñ–ï–ù –ø–æ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è —Å—É—Ö–æ–π –∫–æ–∂–∏)

## üîå API Endpoints

### –ê—Ç—Ä–∏–±—É—Ç—ã

#### GET `/api/admin/attributes`
–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∞—Ç—Ä–∏–±—É—Ç—ã —Å –∏—Ö –∑–Ω–∞—á–µ–Ω–∏—è–º–∏.

**Response:**
```json
[
  {
    "id": "uuid",
    "name": "Farbe",
    "slug": "farbe",
    "type": "select",
    "displayOrder": 1,
    "filterable": true,
    "visibleInCatalog": true,
    "values": [
      {
        "id": "uuid",
        "value": "Rot",
        "slug": "rot",
        "displayOrder": 3
      }
    ]
  }
]
```

#### POST `/api/admin/attributes`
–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∞—Ç—Ä–∏–±—É—Ç.

**Request:**
```json
{
  "name": "Hauttyp",
  "type": "multiselect",
  "filterable": true,
  "visibleInCatalog": true
}
```

#### PATCH `/api/admin/attributes/[id]`
–û–±–Ω–æ–≤–∏—Ç—å –∞—Ç—Ä–∏–±—É—Ç.

#### DELETE `/api/admin/attributes/[id]`
–£–¥–∞–ª–∏—Ç—å –∞—Ç—Ä–∏–±—É—Ç (–∫–∞—Å–∫–∞–¥–Ω–æ —É–¥–∞–ª—è—é—Ç—Å—è –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏ —Å–≤—è–∑–∏).

### –ó–Ω–∞—á–µ–Ω–∏—è –∞—Ç—Ä–∏–±—É—Ç–æ–≤

#### POST `/api/admin/attributes/[id]/values`
–î–æ–±–∞–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –∫ –∞—Ç—Ä–∏–±—É—Ç—É.

**Request:**
```json
{
  "value": "Normale Haut"
}
```

#### DELETE `/api/admin/attributes/values/[valueId]`
–£–¥–∞–ª–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–∞.

### –ü—Ä–∏–≤—è–∑–∫–∞ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –∫ —Ç–æ–≤–∞—Ä–∞–º

#### POST `/api/admin/products/attributes`
–ü—Ä–∏–≤—è–∑–∞—Ç—å –∞—Ç—Ä–∏–±—É—Ç –∫ —Ç–æ–≤–∞—Ä—É.

**Request:**
```json
{
  "productId": "uuid",
  "attributeId": "uuid",
  "attributeValueId": "uuid"  // –î–ª—è select/multiselect
  // –ò–õ–ò
  "customValue": "–¢–µ–∫—Å—Ç"      // –î–ª—è text/number
}
```

### –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç–æ–≤–∞—Ä–æ–≤

#### GET `/api/products?attributes={JSON}`
–ü–æ–ª—É—á–∏—Ç—å –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `attributes` - JSON —Å—Ç—Ä–æ–∫–∞ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏:
  ```json
  {
    "farbe": ["uuid1", "uuid2"],
    "hauttyp": ["uuid3"]
  }
  ```
- `category` - –∫–∞—Ç–µ–≥–æ—Ä–∏—è —Ç–æ–≤–∞—Ä–∞
- `minPrice` - –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞
- `maxPrice` - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞
- `inStock` - —Ç–æ–ª—å–∫–æ –≤ –Ω–∞–ª–∏—á–∏–∏ (true/false)

**–ü—Ä–∏–º–µ—Ä:**
```
GET /api/products?attributes={"farbe":["uuid1"]}&category=face-care&inStock=true
```

## üé® –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### AttributeFilters
–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –±–æ–∫–æ–≤–æ–π –ø–∞–Ω–µ–ª–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –¥–ª—è –∫–∞—Ç–∞–ª–æ–≥–∞.

**Props:**
- `selectedFilters` - –æ–±—ä–µ–∫—Ç —Å –≤—ã–±—Ä–∞–Ω–Ω—ã–º–∏ —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
- `onFilterChange` - callback –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–∞
- `onClearAll` - callback –¥–ª—è —Å–±—Ä–æ—Å–∞ –≤—Å–µ—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```tsx
<AttributeFilters
    selectedFilters={attributeFilters}
    onFilterChange={handleAttributeFilterChange}
    onClearAll={handleClearAllFilters}
/>
```

## üîç –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°–æ–∑–¥–∞–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–∞ "Duft" —Å –∑–∞–ø–∞—Ö–∞–º–∏

```sql
-- –í SQL Editor –∏–ª–∏ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É
INSERT INTO public.attributes (name, slug, type, display_order, filterable)
VALUES ('Duft', 'duft', 'select', 7, true);

-- –ü–æ–ª—É—á–∏—Ç—å ID –∞—Ç—Ä–∏–±—É—Ç–∞
SELECT id FROM public.attributes WHERE slug = 'duft';

-- –î–æ–±–∞–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è
INSERT INTO public.attribute_values (attribute_id, value, slug, display_order) VALUES
    ('attribute-id-here', 'Rose', 'rose', 1),
    ('attribute-id-here', 'Lavendel', 'lavendel', 2),
    ('attribute-id-here', 'Zitrus', 'zitrus', 3);
```

### –ü—Ä–∏–≤—è–∑–∫–∞ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –∫ —Ç–æ–≤–∞—Ä—É –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ

```typescript
// –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ç–æ–≤–∞—Ä–∞
const productId = 'product-uuid';
const attributeData = [
  {
    attributeId: 'farbe-attr-id',
    attributeValueId: 'rot-value-id',
  },
  {
    attributeId: 'volumen-attr-id',
    attributeValueId: '50ml-value-id',
  }
];

for (const attr of attributeData) {
  await fetch('/api/admin/products/attributes', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      productId,
      ...attr
    })
  });
}
```

### –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ

```typescript
const [attributeFilters, setAttributeFilters] = useState<{[key: string]: string[]}>({});

// –ò–∑–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä
const handleFilterChange = (attributeSlug: string, valueIds: string[]) => {
  setAttributeFilters(prev => ({
    ...prev,
    [attributeSlug]: valueIds
  }));
};

// –ü–æ–ª—É—á–∏—Ç—å —Ç–æ–≤–∞—Ä—ã
const params = new URLSearchParams();
if (Object.keys(attributeFilters).length > 0) {
  params.append('attributes', JSON.stringify(attributeFilters));
}
const response = await fetch(`/api/products?${params}`);
```

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –í—Å–µ endpoints –∑–∞—â–∏—â–µ–Ω—ã rate limiting
- –ê–¥–º–∏–Ω-–æ–ø–µ—Ä–∞—Ü–∏–∏ —Ç—Ä–µ–±—É—é—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–æ–ª–∏ —á–µ—Ä–µ–∑ `checkAdmin()`
- RLS –ø–æ–ª–∏—Ç–∏–∫–∏ –≤ Supabase:
  - –í—Å–µ –º–æ–≥—É—Ç —á–∏—Ç–∞—Ç—å –∞—Ç—Ä–∏–±—É—Ç—ã –∏ –∏—Ö –∑–Ω–∞—á–µ–Ω–∏—è
  - –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –º–æ–≥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å/–∏–∑–º–µ–Ω—è—Ç—å/—É–¥–∞–ª—è—Ç—å

## ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- –°–æ–∑–¥–∞–Ω—ã –∏–Ω–¥–µ–∫—Å—ã –Ω–∞ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–æ–ª—è:
  - `attributes.slug`
  - `attributes.filterable`
  - `attribute_values.attribute_id`
  - `product_attributes.product_id`
  - `product_attributes.attribute_id`

- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞:
  - –°–Ω–∞—á–∞–ª–∞ —Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è —Ç–æ–≤–∞—Ä—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ —Ü–µ–Ω–µ –≤ –ë–î
  - –ó–∞—Ç–µ–º –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∞—Ç—Ä–∏–±—É—Ç–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏

## üêõ Troubleshooting

### –ê—Ç—Ä–∏–±—É—Ç—ã –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ –∫–∞—Ç–∞–ª–æ–≥–µ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `filterable = true` –¥–ª—è –∞—Ç—Ä–∏–±—É—Ç–∞
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –∞—Ç—Ä–∏–±—É—Ç–∞ –µ—Å—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è
- –û—á–∏—Å—Ç–∏—Ç–µ –∫–µ—à –±—Ä–∞—É–∑–µ—Ä–∞

### –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—à–∏–±–∫–∏
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ç–æ–≤–∞—Ä—ã –∏–º–µ—é—Ç –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç JSON –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–µ `attributes`

### –û—à–∏–±–∫–∞ "Unauthorized" –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∞—Ç—Ä–∏–±—É—Ç–∞
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –≤–æ—à–ª–∏ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Ç–∞–±–ª–∏—Ü–µ `profiles`

## üìù –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

–í—ã –º–æ–∂–µ—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å:
1. **–î–∏–∞–ø–∞–∑–æ–Ω—ã –∑–Ω–∞—á–µ–Ω–∏–π** –¥–ª—è —á–∏—Å–ª–æ–≤—ã—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ü–µ–Ω–∞ 10-50‚Ç¨)
2. **–¶–≤–µ—Ç–æ–≤—ã–µ –∫–æ–¥—ã** –¥–ª—è –∞—Ç—Ä–∏–±—É—Ç–∞ "Farbe"
3. **–ò–∫–æ–Ω–∫–∏** –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∞—Ç—Ä–∏–±—É—Ç–æ–≤
4. **–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É** –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –ø–æ —Ä–∞–∑–¥–µ–ª–∞–º
5. **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** –º–µ–∂–¥—É –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

–î–ª—è –±–æ–ª—å—à–∏—Ö –º–∞–≥–∞–∑–∏–Ω–æ–≤:
1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∞–≥–∏–Ω–∞—Ü–∏—é —Ñ–∏–ª—å—Ç—Ä–æ–≤
2. –î–æ–±–∞–≤—å—Ç–µ –ø–æ–∏—Å–∫ –ø–æ –∞—Ç—Ä–∏–±—É—Ç–∞–º
3. –ö–µ—à–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –≤ –ë–î

## ‚úÖ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

- ‚úÖ –ü–æ–ª–Ω–∞—è CRUD —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –∞—Ç—Ä–∏–±—É—Ç–æ–≤
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∞—Ç—Ä–∏–±—É—Ç–æ–≤
- ‚úÖ –ê–¥–º–∏–Ω-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —Ñ–æ—Ä–º—É —Å–æ–∑–¥–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞
- ‚úÖ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Ñ–∏–ª—å—Ç—Ä–æ–≤ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ
- ‚úÖ API –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤
- ‚úÖ –ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã –¥–ª—è –∫–æ—Å–º–µ—Ç–∏–∫–∏
- ‚úÖ Responsive –¥–∏–∑–∞–π–Ω
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏
- ‚úÖ RLS –ø–æ–ª–∏—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

## üéâ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –Ω–∞—á–∞—Ç—å —Å–æ–∑–¥–∞–≤–∞—Ç—å –∞—Ç—Ä–∏–±—É—Ç—ã –∏ –Ω–∞–∑–Ω–∞—á–∞—Ç—å –∏—Ö —Ç–æ–≤–∞—Ä–∞–º –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å!
